clc;clear all;
a=@(x)2*x;
b=@(x)x.^2;
c=@(x)3;
f=@(x)exp(x);
n=5;
x0=0;xn=1;
yd1=1;yd2=2;
h=(xn-x0)/n;
x=x0:h:xn;
A=((a(x(2:n))/h^2)-(b(x(2:n))/2*h)).*ones(1,n-1);
A=[A(2:end),0];
B=(c(x(2:n))-2*a(x(2:n))/h^2).*ones(1,n-1);
C=((a(x(2:n))/h^2)+(b(x(2:n))/2*h)).*ones(1,n-1);
C=[0,C(1:end-1)];
M=sparse(n-1,n-1);
M=spdiags([A' B' C'],[-1 0 1],M);
M(1,1)=A(1)+B(1);
M(n-1,n-1)=B(end-1)+C(end-1);
F=f(x(2:n)).*ones(1,n-1);
Al=((a(x(2))/h^2)-(b(x(2))/2*h));
Cl=((a(x(2))/h^2)+(b(x(2))/2*h));
y0=yd1*h;
yn=yd2*h;
F(1)=F(1)-Al*y0;
F(end)=F(end)-Cl*yn;
y=inv(M)*F';
Y=[y0 y' yn];
plot(x,Y)
